const mongoose = require('mongoose');

const campaignSchema = new mongoose.Schema({
    // ‡ßß. ‡¶Æ‡¶æ‡¶≤‡¶ø‡¶ï‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø (‡¶ï‡ßá ‡¶è‡¶á ‡¶ï‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡ßá‡¶á‡¶® ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßá‡¶õ‡ßá)

    timeRequired: { 
        type: Number, 
        default: 60 // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶∞‡¶æ ‡¶ö‡¶æ‡¶á‡¶≤‡ßá ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶¶‡¶ø‡ßü‡ßá ‡¶ü‡¶æ‡¶á‡¶Æ ‡¶¨‡¶æ‡ßú‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá ‡¶≠‡¶¨‡¶ø‡¶∑‡ßç‡¶Ø‡¶§‡ßá
    },

    owner: {
        type: mongoose.Schema.Types.ObjectId,
        ref: 'User',
        required: true
    },

    // ‡ß®. ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ ‡¶è‡¶¨‡¶Ç ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï‡ßá‡¶∞ ‡¶ß‡¶∞‡¶®
    platform: {
        type: String,
        enum: ['youtube', 'facebook', 'tiktok'], // ‡¶≠‡¶¨‡¶ø‡¶∑‡ßç‡¶Ø‡¶§‡ßá ‡¶á‡¶®‡¶∏‡ßç‡¶ü‡¶æ‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ ‡¶è‡¶° ‡¶π‡¶¨‡ßá
        required: true
    },
    actionType: {
        type: String,
        enum: ['subscribe', 'view', 'follow', 'like'],
        required: true
    },
    targetUrl: {
        type: String,
        required: true
    },
    
    // ‡ß©. ‡¶ï‡ßç‡¶Ø‡¶æ‡¶Æ‡ßç‡¶™‡ßá‡¶á‡¶® ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶ì ‡¶ñ‡¶∞‡¶ö
    targetAmount: {
        type: Number,
        required: true // ‡¶Æ‡ßã‡¶ü ‡¶ï‡¶§‡¶ó‡ßÅ‡¶≤‡ßã ‡¶∏‡¶æ‡¶¨‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶æ‡¶á‡¶¨ ‡¶ö‡¶æ‡ßü
    },
    completedCount: {
        type: Number,
        default: 0 // ‡¶è‡¶ñ‡¶® ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶ï‡ßü‡¶ü‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá
    },
    costPerAction: {
        type: Number,
        default: 10 // ‡¶´‡ßç‡¶∞‡¶ø ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶¶‡ßá‡¶∞ ‡¶™‡ßü‡ßá‡¶®‡ßç‡¶ü ‡¶ñ‡¶∞‡¶ö
    },

    // ‡ß™. ‡¶∏‡ßç‡¶™‡ßá‡¶∂‡¶æ‡¶≤ ‡ßß+‡ßß ‡¶≤‡¶ú‡¶ø‡¶ï ‡¶è‡¶¨‡¶Ç ‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡ßü‡¶æ‡¶Æ ‡¶∏‡ßç‡¶≤‡¶ü üî•
    isPremiumSlot: {
        type: Boolean,
        default: false 
    }, 
    // ‡¶Ø‡¶¶‡¶ø true ‡¶π‡ßü, ‡¶§‡¶¨‡ßá ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶è‡¶ï‡ßá ‡¶´‡ßç‡¶∞‡¶ø ‡¶ü‡¶æ‡¶∏‡ßç‡¶ï‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá "‡¶ú‡ßã‡ßú‡¶æ" ‡¶≤‡¶æ‡¶ó‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡¶¨‡ßá (1+1)
    
    priority: {
        type: Number,
        default: 1 // ‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡ßü‡¶æ‡¶Æ ‡¶π‡¶≤‡ßá ‡ßß‡ß¶, ‡¶´‡ßç‡¶∞‡¶ø ‡¶π‡¶≤‡ßá ‡ßß
    },

    // ‡ß´. ‡¶≤‡ßÅ‡¶™ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ (Loop System) üîÑ
    // ‡¶è‡¶á ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶∞‡ßá‡¶§‡ßá ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶•‡¶æ‡¶ï‡¶¨‡ßá ‡¶Ø‡¶æ‡¶∞‡¶æ ‡¶Ö‡¶≤‡¶∞‡ßá‡¶°‡¶ø ‡¶è‡¶á ‡¶ï‡¶æ‡¶ú‡¶ü‡¶æ ‡¶ï‡¶∞‡ßá ‡¶´‡ßá‡¶≤‡ßá‡¶õ‡ßá‡•§
    // ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶¨‡ßá: ‡¶Ø‡¶¶‡¶ø ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶•‡¶æ‡¶ï‡ßá, ‡¶§‡¶¨‡ßá ‡¶§‡¶æ‡¶ï‡ßá ‡¶Ü‡¶∞ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá ‡¶®‡¶æ‡•§
    completedBy: [{
        type: mongoose.Schema.Types.ObjectId,
        ref: 'User'
    }],

    // ‡ß¨. ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤
    status: {
        type: String,
        enum: ['active', 'paused', 'completed', 'banned'],
        default: 'active'
    }

}, { timestamps: true });

// ‡¶™‡¶æ‡¶∞‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶∏ ‡¶Ö‡¶™‡¶ü‡¶ø‡¶Æ‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶® (Searching Fast ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)
campaignSchema.index({ status: 1, isPremiumSlot: -1, priority: -1 });

module.exports = mongoose.model('Campaign', campaignSchema);